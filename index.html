<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salesforce Administrator Mastery - 100 Qs</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans JP', sans-serif; background-color: #f1f5f9; color: #1e293b; overflow-x: hidden; }
        .option-btn:disabled { cursor: not-allowed; }
        .progress-bar { transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .exam-card:hover { transform: translateY(-8px); box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1); }
        .dashboard-card { background: linear-gradient(135deg, #0d1b2a 0%, #1b263b 100%); }
        .animate-fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .modal-overlay { background: rgba(15, 23, 42, 0.85); backdrop-filter: blur(5px); }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 md:p-8">

    <header class="w-full max-w-5xl mb-6 flex justify-between items-center px-2">
        <h1 onclick="location.reload()" class="text-xl md:text-3xl font-black text-slate-800 cursor-pointer flex items-center gap-2">
            <i class="fas fa-user-shield text-cyan-600"></i>
            <span>Administrator <span class="text-cyan-600">Mastery</span></span>
        </h1>
        <div class="bg-white px-4 py-2 rounded-2xl shadow-sm border border-slate-200">
            <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Mistakes</span>
            <span id="header-wrong-count" class="text-lg font-black text-red-500 ml-2">0</span>
        </div>
    </header>

    <main id="app-container" class="w-full max-w-5xl">
        <!-- Dashboard -->
        <div id="selection-screen" class="space-y-6 animate-fade-in">
            <section class="dashboard-card rounded-[2.5rem] p-8 text-white shadow-2xl relative overflow-hidden">
                <div class="relative z-10 flex flex-col md:flex-row justify-between items-center gap-8">
                    <div>
                        <h2 class="text-sm font-black text-cyan-400 uppercase tracking-[0.2em] mb-1">Status Summary</h2>
                        <p class="text-3xl font-black">学習管理ダッシュボード</p>
                    </div>
                    <div class="flex gap-10">
                        <div class="text-center">
                            <span class="block text-[10px] font-bold text-slate-500 uppercase mb-1">Total Ans</span>
                            <span id="dash-total-attempts" class="text-3xl font-black">0</span>
                        </div>
                        <div class="text-center border-l border-slate-800 pl-10">
                            <span class="block text-[10px] font-bold text-slate-500 uppercase mb-1">Accuracy</span>
                            <span id="dash-overall-accuracy" class="text-3xl font-black text-cyan-400">0%</span>
                        </div>
                    </div>
                </div>
            </section>

            <section id="review-section" class="hidden p-6 bg-red-50 rounded-3xl border-2 border-red-100 flex items-center justify-between gap-4">
                <div class="flex items-center gap-4 text-slate-800">
                    <i class="fas fa-redo text-2xl text-red-600"></i>
                    <div>
                        <h3 class="font-black">ニガテ克服チャンス</h3>
                        <p class="text-xs text-slate-500">ミスした <span id="failed-count-display">0</span> 問がストックされています。</p>
                    </div>
                </div>
                <button onclick="quizApp.startReview()" class="bg-red-600 text-white font-black py-3 px-8 rounded-xl">復習開始</button>
            </section>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <button onclick="quizApp.start(false)" class="bg-white rounded-[2rem] p-8 shadow-lg border-b-8 border-slate-900 text-left hover:-translate-y-1 transition">
                    <i class="fas fa-list-ol text-cyan-600 text-2xl mb-4"></i>
                    <h3 class="text-xl font-black mb-2 tracking-tighter">全100問マラソン</h3>
                    <p class="text-xs text-slate-400 font-medium tracking-tight">1番から順に網羅的に学習します。</p>
                </button>
                <button onclick="quizApp.start(true)" class="bg-white rounded-[2rem] p-8 shadow-lg border-b-8 border-cyan-600 text-left hover:-translate-y-1 transition">
                    <i class="fas fa-bolt text-cyan-600 text-2xl mb-4"></i>
                    <h3 class="text-xl font-black mb-2 tracking-tighter">ランダムチャレンジ</h3>
                    <p class="text-xs text-slate-400 font-medium tracking-tight">シャッフルして本番形式で挑みます。</p>
                </button>
            </div>

            <div class="space-y-4">
                <div class="flex justify-between items-center px-2">
                    <h3 class="text-xs font-black text-slate-400 uppercase tracking-widest">Domain Selection</h3>
                    <div class="flex items-center gap-2">
                        <span class="text-[10px] font-bold text-slate-400 uppercase">Overall Progress</span>
                        <div class="w-24 h-1.5 bg-slate-200 rounded-full overflow-hidden">
                            <div id="overall-progress-bar" class="h-full bg-cyan-500 w-0 transition-all duration-1000"></div>
                        </div>
                        <span id="overall-progress-text" class="text-[10px] font-black text-cyan-600">0%</span>
                    </div>
                </div>
                <div id="category-list-container" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3"></div>
            </div>
        </div>

        <!-- Quiz UI -->
        <div id="quiz-screen" class="hidden animate-fade-in w-full">
            <div class="flex justify-between items-center mb-6 px-2">
                <div class="flex items-center gap-4">
                    <button onclick="quizApp.showQuitModal()" class="bg-white w-12 h-12 rounded-full border border-slate-200 shadow-sm flex items-center justify-center text-slate-300 hover:text-red-500 transition-colors"><i class="fas fa-times text-xl"></i></button>
                    <div>
                        <span id="quiz-mode-label" class="block text-[10px] font-black text-cyan-500 uppercase tracking-widest mb-1">Standard Marathon</span>
                        <span id="progress-text" class="text-xl font-black leading-none tracking-tighter">QUESTION 1/100</span>
                    </div>
                </div>
                <span id="score-text" class="text-3xl font-black text-cyan-600 italic">0%</span>
            </div>
            <div class="w-full bg-slate-200 h-3 rounded-full mb-10 overflow-hidden shadow-inner border border-slate-300">
                <div id="progress-bar" class="progress-bar bg-cyan-600 h-full w-0"></div>
            </div>

            <div class="bg-white rounded-[3.5rem] shadow-2xl p-6 md:p-12 border border-slate-100 relative">
                <div id="category-badge" class="inline-block px-5 py-2 rounded-2xl bg-cyan-50 text-cyan-600 text-[10px] font-black mb-10 uppercase tracking-widest border border-cyan-100">CATEGORY</div>
                <h3 id="question-text" class="text-xl md:text-2xl font-bold text-slate-800 mb-12 leading-snug"></h3>
                <div id="options-container" class="grid grid-cols-1 gap-4 mb-8"></div>
                <div id="explanation-container" class="hidden mt-10 pt-10 border-t-2 border-slate-50">
                    <div id="result-badge" class="flex items-center p-6 rounded-2xl mb-6 font-black text-lg italic tracking-widest"></div>
                    <div id="explanation-text" class="text-slate-600 text-sm md:text-base leading-relaxed whitespace-pre-wrap bg-slate-50 p-8 rounded-2xl border border-slate-100 font-medium italic"></div>
                    <button onclick="quizApp.nextQuestion()" class="mt-8 w-full bg-slate-900 text-white font-black py-5 rounded-2xl transition shadow-xl active:scale-95 flex items-center justify-center gap-3">
                        <span>次の問題に進む</span> <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Result Dashboard -->
        <div id="result-screen" class="hidden space-y-10 animate-fade-in pb-20">
            <div class="bg-white rounded-[3.5rem] shadow-2xl p-10 md:p-20 text-center">
                <h2 class="text-3xl font-black text-slate-300 uppercase tracking-[0.5em] mb-4">Complete</h2>
                <div id="final-emoji" class="text-8xl my-10 tracking-tighter italic">🏆</div>
                <div id="final-score" class="text-8xl font-black text-cyan-600 mb-4 tracking-tighter italic">0%</div>
                <p id="final-stats" class="text-slate-400 font-black text-xl mb-12 uppercase tracking-widest"></p>
                <div class="text-left border-t pt-16">
                    <h3 class="text-2xl font-black flex items-center gap-3 mb-10 text-slate-800"><i class="fas fa-chart-line text-cyan-500"></i> 強み・弱み分析</h3>
                    <div class="overflow-hidden rounded-[2.5rem] border border-slate-100 shadow-sm">
                        <table class="w-full text-left">
                            <thead class="bg-slate-50">
                                <tr class="text-[10px] font-black text-slate-400 uppercase tracking-widest">
                                    <th class="p-6">カテゴリ</th>
                                    <th class="p-6 text-right">判定 / 正解率</th>
                                </tr>
                            </thead>
                            <tbody id="analysis-table-body" class="divide-y divide-slate-50"></tbody>
                        </table>
                    </div>
                </div>
                <div class="flex flex-col sm:flex-row gap-4 justify-center mt-16">
                    <button id="result-review-btn" onclick="quizApp.startReview()" class="hidden bg-red-600 text-white font-black py-6 px-12 rounded-3xl shadow-xl transition hover:bg-red-700">ミスした問題を復習</button>
                    <button onclick="location.reload()" class="bg-slate-900 text-white font-black py-6 px-12 rounded-3xl shadow-xl transition hover:bg-black">トップに戻る</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <div id="quit-modal" class="hidden fixed inset-0 z-50 modal-overlay flex items-center justify-center p-4">
        <div class="bg-white rounded-[2.5rem] p-10 max-w-md w-full shadow-2xl animate-fade-in text-center">
            <div class="text-red-500 text-7xl mb-8"><i class="fas fa-question-circle"></i></div>
            <h3 class="text-3xl font-black mb-4">学習を中断しますか？</h3>
            <p class="text-slate-500 mb-12 font-medium">これまでの進捗は保存されますが、セッションは終了します。</p>
            <div class="grid grid-cols-2 gap-4">
                <button onclick="quizApp.hideQuitModal()" class="bg-slate-50 text-slate-500 font-black py-5 rounded-2xl">続ける</button>
                <button onclick="quizApp.quitQuiz()" class="bg-red-600 text-white font-black py-5 rounded-2xl shadow-xl shadow-red-100">中断して戻る</button>
            </div>
        </div>
    </div>

    <script>
        const ADMIN_DATA = [
            // 組織の設定 (1-7)
            { id: 1, cat: "組織の設定 / セキュリティ", q: "Salesforceの会計年度について正しい記述はどれですか？", a: "A. 標準の会計年度は任意の日から開始できる", b: "B. カスタム会計年度を一度有効にすると無効にできない", c: "C. 会計年度を変更するとレポートの履歴データは自動更新されない", d: "D. 標準の会計年度は構造を自由に変更できる", correct: "B", exp: "【正解：B】\n一度カスタム会計年度を有効にすると、標準の会計年度に戻すことはできません。これを有効にする前には必ずサンドボックスでテストする必要があります。\n\n【他の選択肢が不適切な理由】\nA: 標準の会計年度は「任意の月の1日」から開始できますが、「任意の日（例：15日）」からは開始できません。\nC: 会計年度の設定を変更すると、レポートやダッシュボードの履歴も動的に更新されます。\nD: 標準の会計年度は構造（4-4-5形式など）を変更できません。変更が必要な場合はカスタム会計年度を使います。" },
            { id: 2, cat: "組織の設定 / セキュリティ", q: "ユーザーがSalesforceにログインできない。管理者が最初に確認すべき場所は？", a: "A. ユーザーのプロファイル", b: "B. ログイン履歴", c: "C. セキュリティトークン", d: "D. 役割階層", correct: "B", exp: "【正解：B】\nログイン履歴（Setup > Login History）を確認することで、パスワード間違いなのか、IP制限なのか、それとも多要素認証の失敗なのかといった、ログイン失敗の具体的な原因がわかります。\n\n【他の選択肢が不適切な理由】\nA: プロファイルで制限（ログインIP範囲や時間）を確認することは有効ですが、まずは履歴から何が起きているか特定するのが先決です。\nC: セキュリティトークンはAPI経由の接続で重要ですが、ブラウザからの通常のログイン失敗時には最初に確認すべき項目ではありません。\nD: 役割階層はレコードの可視性を制御するもので、ログインの可否には一切関係ありません。" },
            { id: 3, cat: "組織の設定 / セキュリティ", q: "多要素認証 (MFA) の展開について管理者が行うべきことは？", a: "A. ユーザーごとに個別に設定するしかない", b: "B. 権限セットを使用してMFAを有効にする", c: "C. 共有ルールを使用する", d: "D. パスワードポリシーで設定する", correct: "B", exp: "【正解：B】\n「ユーザーインターフェースログインの多要素認証」というシステム権限を、権限セットまたはプロファイルでユーザーに割り当てることで、MFAを有効化します。\n\n【他の選択肢が不適切な理由】\nA: 権限セットを使えば、一括で複数のユーザーに適用できるため、個別設定のみではありません。\nC: 共有ルールはデータの参照権限を制御するもので、ログインのセキュリティ（認証）とは無関係です。\nD: パスワードポリシーは、長さや有効期限、履歴などを管理しますが、MFA（物理的な認証デバイスの使用など）は制御しません。" },
            { id: 4, cat: "組織の設定 / セキュリティ", q: "社内のユーザーが勤務時間外にSalesforceにアクセスできないようにしたい。どこで設定しますか？", a: "A. ログインのIP範囲", b: "B. ログイン時間制限（プロファイル）", c: "C. 組織の共有設定", d: "D. ユーザーレコードの勤務時間", correct: "B", exp: "【正解：B】\nプロファイルレベルで「ログイン時間」を設定できます。時間外にログインしようとすると拒否され、ログイン中に時間を過ぎると強制ログアウトされます（設定によります）。\n\n【他の選択肢が不適切な理由】\nA: ログインIP範囲は「場所（ネットワーク）」による制限であり、時間による制限ではありません。\nC: 組織の共有設定（OWD）は「誰がどのレコードを見られるか」の設定であり、システムへのアクセス自体は制御しません。\nD: ユーザーレコードにある勤務時間の項目は、主に活動やToDoのリマインダーなどの計算に使われるもので、ログインを遮断する機能はありません。" },
            { id: 5, cat: "組織の設定 / セキュリティ", q: "パスワードポリシーの設定において、組織全体のデフォルトを上書きできるのはどこですか？", a: "A. 役割", b: "B. プロファイル", c: "C. ユーザーレコード", d: "D. 権限セット", correct: "B", exp: "【正解：B】\nプロファイルごとに個別のパスワードポリシー（有効期限、複雑さなど）を設定でき、これは組織全体のデフォルト設定（組織のパスワードポリシー）よりも優先されます。\n\n【他の選択肢が不適切な理由】\nA, C: 役割やユーザー個別のレコードには、パスワードの有効期限などのセキュリティ設定を持つことはできません。\nD: 権限セットでは、パスワードの「有効期限」や「複雑さ」などのポリシー設定を管理することはできません（これらはプロファイルに紐付いています）。" },
            { id: 6, cat: "組織の設定 / セキュリティ", q: "信頼済みIP範囲とログインIP範囲（プロファイル）の違いは何ですか？", a: "A. 信頼済みIP範囲はログインを制限する", b: "B. ログインIP範囲に含まれない場合はログインを拒否される", c: "C. 信頼済みIP範囲に含まれない場合はログインを拒否される", d: "D. 両者に違いはない", correct: "B", exp: "【正解：B】\nプロファイルの「ログインIP範囲」は非常に厳格です。範囲外のIPからアクセスした場合、たとえ正しいパスワードを入力してもログインは即座に拒否されます。\n\n【他の選択肢が不適切な理由】\nA: 「ネットワークアクセス（信頼済みIP範囲）」はログインを制限するためのものではなく、その範囲内であれば認証コードの入力をスキップさせるためのものです。\nC: 信頼済みIP範囲外からログインしても拒否はされません。代わりに、登録メールに届く認証コードの入力を求められます。\nD: 全く役割が異なります。ログイン可否（プロファイル）か、認証コード不要（組織全体）かの違いです。" },
            { id: 7, cat: "組織の設定 / セキュリティ", q: "通貨管理において、高度な通貨管理（マルチ通貨）を有効にした場合の影響は？", a: "A. すべての計算が自動で行われる", b: "B. 商談の完了日に基づく期間指定換算レートを使用できる", c: "C. 一度有効にすると戻せない", d: "D. 数式項目がすべて無効になる", correct: "B", exp: "【正解：B】\n高度な通貨管理（Advanced Currency Management）を有効にすると、特定の期間（例：2023年Q1）に適用される換算レートを個別に設定できます。これにより、商談成立時点の正確な換算額を維持できます。\n\n【他の選択肢が不適切な理由】\nA: 計算は設定されたレートに基づいて行われますが、自動ですべてが解決されるわけではなく、レートのメンテナンスは必要です。\nC: 高度な通貨管理は無効化することができます（ただし、期間指定レートのデータは失われます）。マルチ通貨設定そのものは一度有効にすると無効化できませんが、この問題は「高度な〜」について問われています。\nD: 通貨に関わる特定の数式項目で制限が出る場合がありますが、すべての数式が無効になるわけではありません。" },

            // セキュリティとアクセス (8-20)
            { id: 8, cat: "セキュリティとアクセス", q: "組織の共有設定（OWD）が「非公開」のオブジェクトで、所有者以外がレコードを見るには何が必要ですか？", a: "A. 役割階層", b: "B. 共有ルール", c: "C. 手動共有", d: "D. 上記すべて", correct: "D", exp: "【正解：D】\nOWDが「非公開」の場合、所有者のみが参照できます。このアクセス権を広げる手段として、垂直方向の「役割階層」、条件に基づき水平方向に広げる「共有ルール」、個別に1件ずつ共有する「手動共有」のすべてが利用可能です。\n\n【補足】\nSalesforceのセキュリティモデルは「まずはOWDで最も厳しく制限し、他の手段で例外的にアクセスを広げる」という足し算の考え方に基づいています。" },
            { id: 9, cat: "セキュリティとアクセス", q: "特定の項目を特定のユーザーにだけ見せたくない場合、何を使用しますか？", a: "A. ページレイアウト", b: "B. 項目レベルセキュリティ", c: "C. 共有ルール", d: "D. レコードタイプ", correct: "B", exp: "【正解：B】\n項目レベルセキュリティ（FLS）は、特定のプロファイルに対して項目の「参照」または「編集」を禁止します。これはレポートや検索結果、リストビューからも隠れるため、最も確実なデータ保護手段です。\n\n【他の選択肢が不適切な理由】\nA: ページレイアウトで非表示にしても、レポートやAPI経由では見えてしまうため、セキュリティ対策としては不十分です。\nC: 共有ルールはレコード全体の可視性を制御するもので、特定の項目だけを隠すことはできません。\nD: レコードタイプはページレイアウトや選択リスト値を切り替えるためのものであり、アクセス権の制御が主な目的ではありません。" },
            { id: 10, cat: "セキュリティとアクセス", q: "役割階層を使用してアクセス権を付与したくないカスタムオブジェクトがあります。どう設定しますか？", a: "A. 組織の共有設定で「階層を使用したアクセス許可」をオフにする", b: "B. 共有ルールを削除する", c: "C. プロファイルで非表示にする", d: "D. 役割を削除する", correct: "A", exp: "【正解：A】\nカスタムオブジェクトのOWD設定画面で「階層を使用したアクセス許可（Grant Access Using Hierarchies）」のチェックを外すことができます。これにより、上位の上司であっても部下のレコードを自動で見ることはできなくなります。\n\n【重要な注意】\n取引先、取引先責任者、商談、リードなどの標準オブジェクトでは、このチェックを外すことはできず、常に役割階層によるアクセスが許可されます。" },
            { id: 11, cat: "セキュリティとアクセス", q: "ユーザーが「商談」の削除権限を持っていません。権限セットで付与できますか？", a: "A. はい", b: "B. いいえ", correct: "A", exp: "【正解：A】\n権限セットは、ベースとなるプロファイルにさらに権限を「追加」するために使用されます。プロファイルで削除権限がなくても、権限セットで付与すればそのユーザーは削除が可能になります。\n\n【ポイント】\n権限セットは権限を増やす（許可する）ことはできますが、プロファイルですでに許可されている権限を「剥奪」することはできません。" },
            { id: 12, cat: "セキュリティとアクセス", q: "外部ユーザーに特定のレコードへのアクセスを許可したい。最も適切な共有設定は？", a: "A. 共有セット", b: "B. 公開グループ", c: "C. 組織全体のデフォルトを公開にする", d: "D. 管理者権限を付与", correct: "A", exp: "【正解：A】\nCustomer Community などのライセンスを持つ外部ユーザーには、役割階層が適用されません。そのため、取引先責任者とレコードの紐付け（Account IDが一致するなど）に基づいてアクセスを許可する「共有セット」を使用します。\n\n【他の選択肢が不適切な理由】\nB: 公開グループは主に内部ユーザー向けです（一部のパートナーライセンス等を除き、通常のカスタマーには不向きです）。\nC: 外部ユーザーも含めた全公開はセキュリティリスクが非常に高いため推奨されません。\nD: 管理者権限は絶対にいけません。" },
            { id: 13, cat: "セキュリティとアクセス", q: "レコードの所有者を変更できるのは誰ですか？（2つ選択）", a: "A. 現在の所有者", b: "B. 役割階層で所有者より上位のユーザー", c: "C. すべてのデータの編集権限を持つ管理者", d: "D. 参照権限を持つすべてのユーザー", correct: "A, C", exp: "【正解：A, C】\nレコード所有権の変更には、通常「現在の所有者」であるか、システム権限として「すべてのデータの編集」を持つ必要があります。\n\n【他の選択肢が不適切な理由】\nB: 上位ユーザーは「編集」はできますが、「所有権の譲渡」を行うには特定の権限が必要です（リードなど一部の例外を除く）。\nD: 単なる参照権限では所有者の変更はできません。" },
            { id: 14, cat: "セキュリティとアクセス", q: "公開グループには、どのようなメンバーを含めることができますか？", a: "A. 個々のユーザー", b: "B. 他の公開グループ", c: "C. 特定の役割", d: "D. 上記すべて", correct: "D", exp: "【正解：D】\n公開グループ（Public Group）は非常に柔軟です。特定のユーザー、役割、役割およびその下位、さらに別のグループを入れ子にして構成することができます。\n\n【活用場面】\n「複数の拠点にまたがる特定のプロジェクトチーム」などにアクセス権を一括で与えたい時に便利です。" },
            { id: 15, cat: "セキュリティとアクセス", q: "共有ルールの目的は何ですか？", a: "A. アクセス制限を厳しくする", b: "B. 例外的にアクセス権を広げる", c: "C. データの削除を防ぐ", d: "D. ページレイアウトを変更する", correct: "B", exp: "【正解：B】\nOWDで「非公開」や「公開/参照のみ」に制限されている環境で、特定の条件（例：東京支店の商談は本部の営業事務も見えるようにする）に基づき、アクセス権を拡張するために使用します。\n\n【不適切な理由】\nA: 共有ルールでアクセスを制限することはできません。制限はOWDで行います。\nC, D: これらはプロファイルやページレイアウトの役割です。" },
            { id: 16, cat: "セキュリティとアクセス", q: "「表示」を許可するが「編集」を禁止したい。どこで設定しますか？", a: "A. 共有ルール", b: "B. プロファイル（または権限セット）", c: "C. OWD", d: "D. ページレイアウト", correct: "B", exp: "【正解：B】\n特定のオブジェクト（例：商談）に対して、レコードそのものを「作成」「編集」「削除」できるかどうかという根本的な操作権限は、プロファイル（または権限セット）で設定します。\n\n【他の選択肢が不適切な理由】\nA: 共有ルールは「見えるか見えないか」の範囲を広げるものです。\nC: OWDもデータの可視性のベースラインを決めるものです。\nD: ページレイアウトで「参照のみ」に設定しても、APIや一括更新などを使えば編集できてしまうため、完全な禁止にはなりません。" },
            { id: 17, cat: "セキュリティとアクセス", q: "パスワードを忘れたユーザーに対して管理者が行うべきことは？", a: "A. 新しいパスワードをメールで教える", b: "B. パスワードのリセットボタンを押す", c: "C. プロファイルを変更する", d: "D. ユーザーを一度無効化する", correct: "B", exp: "【正解：B】\n管理者はユーザーの現在のパスワードを見ることも、直接書き換えることもできません。リセットボタンを押すと、ユーザーに「パスワード再設定URL」が記載されたメールが届きます。\n\n【不適切な理由】\nA: 管理者はパスワードを知ることができないため、教えることは不可能です。\nC, D: これらは問題の解決になりません。" },
            { id: 18, cat: "セキュリティとアクセス", q: "ユーザーを無効化できない状況はどれですか？", a: "A. 役割が割り当てられている場合", b: "B. カスタム階層項目の受信者になっている場合", c: "C. ワークフローのデフォルト承認者になっている場合", d: "D. Chatterを有効にしている場合", correct: "C", exp: "【正解：C】\nそのユーザーが「デフォルトの承認者」などの重要なシステム設定に組み込まれている場合、先にその設定を変更しないと無効化できません。他にも「ダッシュボードの実行ユーザー」などの場合も同様です。\n\n【不適切な理由】\nA, B, D: これらは無効化の妨げにはなりません。役割が割り当てられていても無効化できます。" },
            { id: 19, cat: "セキュリティとアクセス", q: "レコードタイプの主な目的は何ですか？", a: "A. データのセキュリティを強化する", b: "B. 異なるビジネスプロセス、選択リスト値、ページレイアウトを表示する", c: "C. 項目の編集を禁止する", d: "D. ストレージ容量を節約する", correct: "B", exp: "【正解：B】\nレコードタイプを使用すると、1つのオブジェクト内で「法人営業用」と「個人営業用」で異なる商談フェーズ（プロセス）を持たせたり、表示する項目（ページレイアウト）を変えたりできます。\n\n【注意】\nレコードタイプだけでセキュリティ（参照権限）を制御することはできません。可視性はあくまでOWDやプロファイルが優先されます。" },
            { id: 20, cat: "セキュリティとアクセス", q: "代理管理者が実行できるアクションはどれですか？", a: "A. プロファイルの作成", b: "B. 特定の役割のユーザー作成・編集", c: "C. 全ユーザーのパスワード変更", d: "D. 組織の共有設定の変更", correct: "B", exp: "【正解：B】\n代理管理者は、管理権限を一部委譲されたユーザーです。指定された役割のユーザー管理（パスワードリセット含む）や、指定されたカスタムオブジェクトの管理ができます。\n\n【他の選択肢が不適切な理由】\nA, D: プロファイルの作成や組織全体のセキュリティ設定（OWD）の変更は、フル権限を持つシステム管理者のみが行えます。" },

            // オブジェクトマネージャと App Builder (21-35)
            { id: 21, cat: "オブジェクトマネージャと App Builder", q: "主従関係について正しい記述はどれですか？", a: "A. 標準オブジェクトは従側になれる", b: "B. 主レコードを削除すると従レコードも削除される", c: "C. 従レコードに所有者項目が存在する", d: "D. 1つのオブジェクトに最大10個作成できる", correct: "B", exp: "【正解：B】\n主従関係の最大の特徴は「密な結合」です。親（主）レコードを削除すると、紐付いている子（従）レコードもすべて自動的に削除（連鎖削除）されます。\n\n【他の選択肢が不適切な理由】\nA: 標準オブジェクトは常に「主側」にしかなれず、「従側」になることはできません。\nC: 従レコードには「所有者」項目はなく、アクセス権は主レコードの所有者に依存します。\nD: 1つのオブジェクトに作成できる主従関係は最大「2つ」までです。" },
            { id: 22, cat: "オブジェクトマネージャと App Builder", q: "参照関係（Lookup）と主従関係（Master-Detail）の最大の違いは？", a: "A. 参照関係は必須項目である必要がある", b: "B. 主従関係はセキュリティが主レコードに従う", c: "C. 参照関係は積み上げ集計が使える", d: "D. 主従関係は標準オブジェクトを従側にできる", correct: "B", exp: "【正解：B】\n主従関係では、子レコードの可視性や編集権限が親レコードの所有権に連動します。対して参照関係は、親レコードと子レコードで別々の所有者・アクセス権を持つことができます。\n\n【補足】\n積み上げ集計は主従関係でのみ使用可能です（例外として「取引先と商談」などの標準の特別な関係を除きます）。" },
            { id: 23, cat: "オブジェクトマネージャと App Builder", q: "商談の合計金額を取引先に自動で表示したい。どの項目タイプを使いますか？", a: "A. 数式項目", b: "B. 積み上げ集計項目", c: "C. テキスト項目", d: "D. 外部参照項目", correct: "B", exp: "【正解：B】\n積み上げ集計項目（Roll-up Summary）を使えば、子レコードの特定項目の「合計」「最小値」「最大値」「件数」を親レコードに表示できます。\n\n【不適切な理由】\nA: 数式項目は「自レコード」または「親レコード」の値しか参照できません。子レコードの値を集計して表示することはできません。" },
            { id: 24, cat: "オブジェクトマネージャと App Builder", q: "数式項目で計算可能なものはどれですか？", a: "A. 同じレコードの他の項目", b: "B. 親レコードの項目", c: "C. 子レコードの件数", d: "D. AとB", correct: "D", exp: "【正解：D】\n数式は、自身のレコード内の項目のほか、参照関係や主従関係を辿って「親」「その上の親（最大10階層）」までの項目（クロスオブジェクト数式）を参照して計算できます。\n\n【不適切な理由】\nC: 子レコード側の情報は、数式項目では取得できません。それには「積み上げ集計」が必要です。" },
            { id: 25, cat: "オブジェクトマネージャと App Builder", q: "バリデーションルール（入力規則）が実行されるタイミングは？", a: "A. レコードが保存される前", b: "B. レコードが保存された後", c: "C. ページが開かれた時", d: "D. ワークフローが実行された後", correct: "A", exp: "【正解：A】\n入力規則は、ユーザーが「保存」ボタンを押した後、データが実際にデータベースにコミットされる「前」に実行されます。エラーがあれば保存は中断されます。\n\n【補足】\nSalesforceの実行順序（Execution Order）では、システムによる入力チェックの後、ユーザー定義の入力規則が走ります。" },
            { id: 26, cat: "オブジェクトマネージャと App Builder", q: "Lightningアプリケーションビルダーで作成できるページタイプは？（3つ選択）", a: "A. アプリケーションページ", b: "B. ホームページ", c: "C. レコードページ", d: "D. レポートページ", correct: "A, B, C", exp: "【正解：A, B, C】\nアプリケーションビルダーでは、アプリ全体のダッシュボードとしての「アプリケーションページ」、ログイン直後に見る「ホームページ」、各データの詳細画面である「レコードページ」の3種類をノーコードで作成できます。\n\n【不適切な理由】\nD: 「レポートページ」というページタイプは存在しません。レポートを表示したい場合は、他のページタイプの中にレポートグラフコンポーネントを配置します。" },
            { id: 27, cat: "オブジェクトマネージャと App Builder", q: "商談の「フェーズ」ごとに異なる項目を表示したい。何を使いますか？", a: "A. ページレイアウト", b: "B. 動的フォーム（Dynamic Forms）", c: "C. 共有ルール", d: "D. 数式項目", correct: "B", exp: "【正解：B】\n動的フォーム（Dynamic Forms）を使用すると、レコードページ上の「項目」や「セクション」に対して、表示条件（例：フェーズが成立の時だけ表示）を個別に設定できます。\n\n【不適切な理由】\nA: ページレイアウトでも切り替えは可能ですが、レコードタイプの切り替えが必要になり、設定が複雑になります。動的フォームの方が柔軟です。" },
            { id: 28, cat: "オブジェクトマネージャと App Builder", q: "外部ID（External ID）として指定できるデータ型は？", a: "A. テキスト", b: "B. 数値", c: "C. メール", d: "D. 上記すべて", correct: "D", exp: "【正解：D】\n外部IDは、外部システム（ERPなど）にあるユニークなキーを保持するための項目です。テキスト、数値、メール型の項目を「外部ID」として定義でき、これを使って「アップサート（更新または挿入）」が可能です。\n\n【ポイント】\n1つのオブジェクトにつき最大「25個」まで設定可能です。" },
            { id: 29, cat: "オブジェクトマネージャと App Builder", q: "オブジェクトの「ヘルプテキスト」はどこに表示されますか？", a: "A. ページの上部", b: "B. 項目の横にある i アイコン", c: "C. 保存時のエラーメッセージ", d: "D. レポートの見出し", correct: "B", exp: "【正解：B】\n項目定義で設定したヘルプテキストは、編集・詳細画面で項目名の横にある「i」アイコンにマウスホバー（またはタップ）した際にポップアップで表示されます。\n\n【活用】\nユーザーに「この項目には何を入力すべきか」というガイドを提示するのに最適です。" },
            { id: 30, cat: "カスタム項目のデータ型を変更する際、注意すべきことは？", a: "A. データが失われる可能性がある", b: "B. 変更はいつでも自由に行える", c: "C. 変更後も以前のデータはそのまま残る", d: "D. 管理者権限があればデータ損失は起きない", correct: "A", exp: "【正解：A】\n例えば「テキスト型」から「数値型」に変更する場合、テキストに数字以外が入っていると、変換できずにデータが削除（NULL化）される可能性があります。\n\n【重要な注意】\nデータ型の変更前には必ずバックアップを取るか、サンドボックスで影響を確認する必要があります。" },
            { id: 31, cat: "オブジェクトマネージャと App Builder", q: "商談の「完了予定日」が過去の日付で保存されないようにしたい。何を使いますか？", a: "A. デフォルト値", b: "B. 入力規則", c: "C. 自動起動フロー", d: "D. ページレイアウト", correct: "B", exp: "【正解：B】\n「CloseDate < TODAY()」という数式を入力規則に設定することで、保存時に日付をチェックし、過去であればエラーメッセージを表示して保存を阻止できます。\n\n【不適切な理由】\nA: デフォルト値は新規作成時の初期値であり、その後の変更や保存時のチェックは行いません。\nD: ページレイアウトでは項目の「必須」や「参照のみ」は設定できますが、日付の前後関係のようなロジックチェックはできません。" },
            { id: 32, cat: "オブジェクトマネージャと App Builder", q: "ジャンクションオブジェクト（多対多関係）を作成するために必要なものは？", a: "A. 2つの参照関係", b: "B. 2つの主従関係", c: "C. 1つの主従関係と1つの参照関係", d: "D. 特別なプラグイン", correct: "B", exp: "【正解：B】\n例えば「学生」と「授業」の関係（一人が複数の授業を受け、一つの授業に複数の学生がいる）を作るには、中間オブジェクトを作り、そのオブジェクトから2つの親へ向けて「主従関係」を作成します。\n\n【ポイント】\n中間オブジェクトから見て、2つの親レコードが削除されると中間レコードも消える仕組みです。" },
            { id: 33, cat: "オブジェクトマネージャと App Builder", q: "クイックアクションでできることは？（2つ選択）", a: "A. レコードの作成", b: "B. 項目の更新", c: "C. レポートの削除", d: "D. 共有設定の変更", correct: "A, B", exp: "【正解：A, B】\nクイックアクションを使えば、ボタン一つで「関連する活動を入力する」や「特定の項目をクローズに変更する」といった定型操作を素早く実行できます。\n\n【不適切な理由】\nC, D: これらはシステム管理の操作であり、レコード上のクイック操作としては提供されていません。" },
            { id: 34, cat: "オブジェクトマネージャと App Builder", q: "パス（Path）コンポーネントは何のために使用されますか？", a: "A. データのインポート", b: "B. ビジネスプロセスの視覚化とガイダンス", c: "C. ユーザーの削除", d: "D. グラフの表示", correct: "B", exp: "【正解：B】\nフェーズやステータスの進捗を視覚化します。また、各ステップで「成功へのガイダンス」として入力すべき項目やアドバイスを表示でき、営業担当者のトレーニングを助けます。\n\n【不適切な理由】\nA, C, D: これらはインポートウィザード、ユーザー設定、ダッシュボード等の役割です。" },
            { id: 35, cat: "オブジェクトマネージャと App Builder", q: "カスタムタブの種類は？（3つ選択）", a: "A. カスタムオブジェクトタブ", b: "B. Webタブ", c: "C. Visualforceタブ", d: "D. レポートタブ", correct: "A, B, C", exp: "【正解：A, B, C】\nカスタムタブを使えば、作成したオブジェクトの他、外部のWebサイト、または独自開発したVisualforce（およびLightningページ）をナビゲーションバーに表示できます。\n\n【不適切な理由】\nD: 「レポート」は標準タブとして存在しますが、「カスタムタブ」として新しく作成する種類には含まれません。" },

            // 以降の問題も同様に詳細化（36-100）
            { id: 36, cat: "営業およびマーケティングアプリケーション", q: "リードの変換（コンバート）時に作成されるレコードは？", a: "A. 取引先、取引先責任者、商談", b: "B. 取引先、ケース、商談", c: "C. リード、取引先、商談", d: "D. 取引先責任者のみ", correct: "A", exp: "【正解：A】\n「見込み客」であるリードを変換すると、その所属先である「取引先」、担当者である「取引先責任者」、そして商談（任意）が作成されます。\n\n【補足】\n既存の取引先や取引先責任者がいる場合は、新しく作らずに「既存のレコードに紐付ける」ことも可能です。" },
            { id: 37, cat: "営業およびマーケティングアプリケーション", q: "Web-to-リードで1日に処理できる最大数は？", a: "A. 100", b: "B. 500", c: "C. 5,000", d: "D. 無制限", correct: "C", exp: "【正解：C】\n24時間あたり最大5,000件です。これを超えると、Salesforceはリクエストをキューに保持し、翌日に処理するか、管理者に通知を送ります。\n\n【活用】\n会社のホームページのお問い合わせフォームなどから直接リードを取り込むのに使われます。" },
            { id: 38, cat: "営業およびマーケティングアプリケーション", q: "キャンペーンの影響（Campaign Influence）とは何ですか？", a: "A. キャンペーンが商談成約に与えた影響を追跡する", b: "B. メールの開封率を測定する", c: "C. リードの質をスコアリングする", d: "D. 商談のフェーズを進める", correct: "A", exp: "【正解：A】\n1つの商談が成立するまでに、複数のキャンペーン（展示会、Web広告など）が関わることがあります。どのキャンペーンがどれくらい寄与したかを分析するための機能です。\n\n【補足】\nこれにより、マーケティング投資対効果（ROI）を可視化できます。" },
            { id: 39, cat: "営業およびマーケティングアプリケーション", q: "商談チーム（Opportunity Team）を使用するメリットは？", a: "A. 商談レコードの削除を防ぐ", b: "B. 複数のユーザーが協力して1つの商談を進め、アクセス権を付与する", c: "C. コミッションを自動計算する", d: "D. 売上予測を停止する", correct: "B", exp: "【正解：B】\n複雑なB2B営業などで、営業担当、技術担当、法務担当などが1つの商談を共同で進める際、それぞれに適切なアクセス権（参照・更新）を自動で与えることができます。\n\n【不適切な理由】\nC: 「商談分割」機能を使えば売上配分は管理できますが、商談チームそのものはアクセス権の管理が主目的です。" },
            { id: 40, cat: "営業およびマーケティングアプリケーション", q: "売上予測（Forecasting）で集計される金額は？", a: "A. 総売上のみ", b: "B. 商談ステージに基づく金額（パイプライン、最善、達成予測など）", c: "C. キャンペーンの予算", d: "D. ケースの解決数", correct: "B", exp: "【正解：B】\n商談の「フェーズ」に紐付いた「売上予測分類」ごとに集計されます。これにより「確実な売上（達成）」と「まだ未定の案件（パイプライン）」を分けて予測できます。" },
            { id: 41, cat: "営業およびマーケティングアプリケーション", q: "価格表（Price Book）の用途は何ですか？", a: "A. ユーザーの給与管理", b: "B. 異なる顧客（法人、個人、地域など）に異なる価格で商品を販売する", c: "C. 在庫管理", d: "D. 税金の計算", correct: "B", exp: "【正解：B】\n1つの「商品」に対して、国内用価格、海外用価格、またはお得意様用価格など、複数の販売価格を管理できます。\n\n【ポイント】\nすべての商品はまず「標準価格表」に登録されている必要があり、その後にカスタム価格表を作成します。" },
            { id: 42, cat: "営業およびマーケティングアプリケーション", q: "見積（Quotes）から商談への同期（Sync）について正しいのは？", a: "A. 複数の見積を同時に同期できる", b: "B. 同期できるのは一度に1つの見積のみ", c: "C. 同期は手動でしか行えない", d: "D. 同期すると商品がすべて削除される", correct: "B", exp: "【正解：B】\n1つの商談に複数の見積案（プランA, プランBなど）を作成できますが、商談の金額や商品と連動（同期）させることができるのは、そのうちの1つだけです。\n\n【補足】\n同期を別の見積に切り替えると、商談側の金額や商品リストも新しい見積の内容に上書きされます。" },
            { id: 43, cat: "営業およびマーケティングアプリケーション", q: "「取引先責任者の役割」はどこで使用されますか？", a: "A. 商談やケース", b: "B. リードのみ", c: "C. プロファイル設定", d: "D. 通貨管理", correct: "A", exp: "【正解：A】\n商談において「この人は意思決定者」「この人は技術担当」といった役割を定義します。これにより、誰が成約のキーマンなのかを把握できます。\n\n【補足】\nケースでも同様に、その問題に関わる関係者の役割を定義するのに使われます。" },
            { id: 44, cat: "営業およびマーケティングアプリケーション", q: "自動割り当てルール（Assignment Rules）が機能するのはどのオブジェクトですか？", a: "A. リード、ケース", b: "B. 商談、取引先", c: "C. カスタムオブジェクトのみ", d: "D. すべてのオブジェクト", correct: "A", exp: "【正解：A】\n流入したリードやケースを、「都道府県が東京なら東京チームへ」といった条件で、ユーザーやキューに自動で割り振ります。\n\n【補足】\n商談や取引先には標準の割り当てルールはないため、フローなどを使って自作する必要があります。" },
            { id: 45, cat: "営業およびマーケティングアプリケーション", q: "キャンペーンメンバーとして登録できるのは誰ですか？", a: "A. リード、取引先責任者", b: "B. 取引先、商談", c: "C. ユーザーのみ", d: "D. 外部の取引先責任者のみ", correct: "A", exp: "【正解：A】\nキャンペーン（メール配信やセミナー）の対象となるのは、個人単位のデータである「リード」または「取引先責任者」です。\n\n【不適切な理由】\nB: 「会社（取引先）」全体をメンバーにすることはできません。必ずその会社の「担当者（取引先責任者）」を登録します。" },
            { id: 46, cat: "営業およびマーケティングアプリケーション", q: "商談の「完了 - 成約」時に自動的にメールを送りたい。何を使いますか？", a: "A. 割り当てルール", b: "B. フロー", c: "C. レコードタイプ", d: "D. 共有ルール", correct: "B", exp: "【正解：B】\nレコードトリガーフロー（Record-Triggered Flow）を使用し、条件を「StageName が Closed Won に変更された時」に設定して、メール送信アクションを実行します。\n\n【不適切な理由】\nA: 割り当てルールは所有者を決めるためのものです。\nC, D: これらは表示やアクセス権のための設定です。" },
            { id: 47, cat: "営業およびマーケティングアプリケーション", q: "受注済みの商談で商品項目を編集したいができない。なぜですか？", a: "A. 受注後はロックされる", b: "B. 見積と同期している", c: "C. 権限がない", d: "D. AまたはBの可能性がある", correct: "D", exp: "【正解：D】\n見積と同期している商談の商品は、見積側からのみ編集可能になります。また、プロセスの設定で受注後にレコードをロック（編集不可に）している場合も考えられます。" },
            { id: 48, cat: "営業およびマーケティングアプリケーション", q: "リードの重複を防ぐために管理者が設定すべき機能は？", a: "A. 重複ルールと一致ルール", b: "B. バリデーションルール", c: "C. フロー", d: "D. プロファイル", correct: "A", exp: "【正解：A】\n「一致ルール」で重複とみなす条件（例：メールアドレスが完全一致）を決め、「重複ルール」でその時に保存をブロックするか、警告だけ出すかを決めます。\n\n【不適切な理由】\nB: 入力規則でも可能ですが、部分一致や曖昧な一致の判定は重複・一致ルールの方が圧倒的に強力です。" },
            { id: 49, cat: "営業およびマーケティングアプリケーション", q: "コンテンツ配信（Content Delivery）の機能は？", a: "A. ファイルをURLとして外部に共有し、閲覧状況を追跡する", b: "B. 社内メールを送る", c: "C. 動画を編集する", d: "D. レポートをエクスポートする", correct: "A", exp: "【正解：A】\nファイルをアップロードして専用URLを発行し、顧客に送ります。顧客がそのURLを開いたか、ファイルをダウンロードしたかを記録できます。また、有効期限やパスワードも設定可能です。" },
            { id: 50, cat: "営業およびマーケティングアプリケーション", q: "商談のフェーズを戻した際、以前の履歴を確認したい。何を見ますか？", a: "A. ステージ履歴（商談履歴）関連リスト", b: "B. Chatter", c: "C. ごみ箱", d: "D. セットアップログ", correct: "A", exp: "【正解：A】\n商談では「金額」「完了予定日」「フェーズ」の変更が標準で自動追跡されます。関連リストを確認することで、いつ、誰が、どの値からどの値へ変更したかが一目でわかります。" },

            // 問題51〜100（同様に解説を強化したデータを100問目まで保持）
            { id: 51, cat: "サービスおよびサポートアプリケーション", q: "ケースの自動割り当てルールについて正しいのは？", a: "A. 複数のルールが同時に実行される", b: "B. ルール内の最初の一致したエントリーのみが実行される", c: "C. ユーザーが手動で選ぶ", d: "D. 常に管理者に割り当てられる", correct: "B", exp: "【正解：B】\n割り当てルールは「順序」が重要です。上から順に条件を判定し、最初に合致したルールが適用され、その後の判定は行われません。\n\n【ポイント】\n「その他すべて」を拾うために、一番最後に条件の緩いルールを置くのが一般的です。" },
            { id: 52, cat: "サービスおよびサポートアプリケーション", q: "エスカレーションルール（Escalation Rules）の用途は？", a: "A. ケースを削除する", b: "B. 特定時間内に解決しないケースを上位者や別のキューに回す", c: "C. メールの自動返信", d: "D. アンケートの送付", correct: "B", exp: "【正解：B】\n顧客への回答期限（SLA）を過ぎそうなケースを検知し、自動的にマネージャーへ通知したり、緊急対応キューへ所有者を変更したりします。\n\n【不適切な理由】\nC: メールの自動返信は「自動レスポンスルール」で行います。" },
            { id: 53, cat: "サービスおよびサポートアプリケーション", q: "ケースの「キュー（Queue）」とは何ですか？", a: "A. 個人のフォルダ", b: "B. 複数のユーザーが共有して待機しているレコードの受け皿", c: "C. レポートの保存先", d: "D. ゴミ箱", correct: "B", exp: "【正解：B】\n担当者が決まっていない案件を一時的に入れておく「共用の待機場所」です。サポートチームのメンバーはここから自分の案件を取り出します。" },
            { id: 54, cat: "サービスおよびサポートアプリケーション", q: "Salesforce ナレッジ（Knowledge）を利用するために必要なライセンスは？", a: "A. Salesforce 標準ライセンス", b: "B. Knowledge User 機能ライセンス", c: "C. Marketing Cloud ライセンス", d: "D. ライセンスは不要", correct: "B", exp: "【正解：B】\nナレッジ記事を「作成」「編集」「公開」するユーザーのレコードで、「ナレッジユーザー」のチェックボックスをオンにする必要があります。これには追加のライセンス費用がかかる場合があります。" },
            { id: 55, cat: "サービスおよびサポートアプリケーション", q: "ケースに対してメールで回答を送った際、自動でケースをクローズしたい。何を使いますか？", a: "A. ワークフロー", b: "B. フロー", c: "C. エスカレーションルール", d: "D. 割り当てルール", correct: "B", exp: "【正解：B】\n「メールメッセージ」レコードが作成されたことをトリガーに、親レコードである「ケース」のステータスを更新するフローを作成します。柔軟な自動化にはフローが最適です。" },
            { id: 56, cat: "サービスおよびサポートアプリケーション", q: "ケースの「マイルストーン」とは何ですか？", a: "A. 完了後のアンケート", b: "B. サポートプロセスの各ステップ（最初の回答までの時間など）の期限", c: "C. レポートのグラフ名", d: "D. ユーザーのランク", correct: "B", exp: "【正解：B】\n「エンタイトルメント（権利）」管理の一部です。「1時間以内に最初の返信をする」「4時間以内に解決する」といった、守るべき期限をカウントダウン表示し、管理します。" },
            { id: 57, cat: "サービスおよびサポートアプリケーション", q: "Web-to-ケースで取り込まれたケースの所有者はどうなりますか？", a: "A. 常にシステム管理者", b: "B. デフォルトのケース所有者（または割り当てルールによる）", c: "C. 顧客本人", d: "D. 空欄になる", correct: "B", exp: "【正解：B】\n割り当てルールが設定されていればそれに従います。ルールがない、またはどれにも合致しない場合は、「サポート設定」で指定された「デフォルトのケース所有者」になります。" },
            { id: 58, cat: "サービスおよびサポートアプリケーション", q: "顧客が自分でケースの状況を確認できる場所はどこですか？", a: "A. Experience Cloud サイト（コミュニティ）", b: "B. Salesforce セットアップ", c: "C. レポート", d: "D. AppExchange", correct: "A", exp: "【正解：A】\nExperience Cloud（旧コミュニティ）を使えば、顧客専用のポータルサイトを作成でき、そこで自分の問い合わせ履歴やナレッジ記事の閲覧が可能になります。" },
            { id: 59, cat: "サービスおよびサポートアプリケーション", q: "解決策（Solutions）とナレッジ（Knowledge）の違いは？", a: "A. 解決策は旧機能で、ナレッジはより高度な記事管理が可能", b: "B. ナレッジは無料だが解決策は有料", c: "C. 解決策の方が多機能", d: "D. 違いはない", correct: "A", exp: "【正解：A】\n「解決策」は古い機能で、現在は「ナレッジ」への移行が推奨されています。ナレッジは多言語対応、承認プロセス、記事タイプ（データカテゴリ）など非常に多機能です。" },
            { id: 60, cat: "サービスおよびサポートアプリケーション", q: "ケースチームを使用する理由は？", a: "A. ケースを削除するため", b: "B. 1つのケースに複数の担当者（技術担当、営業担当など）を関与させるため", c: "C. メールを一括送信するため", d: "D. 商談をクローズするため", correct: "B", exp: "【正解：B】\n1つの複雑な問い合わせに対し、役割の異なる複数のユーザーが協力して解決にあたる際、チームとしてアクセス権や役割を管理するために使います。" },

            // データと分析の管理 (61-80)
            { id: 61, cat: "データと分析の管理", q: "インポートウィザードでインポートできる最大レコード数は？", a: "A. 5,000", b: "B. 50,000", c: "C. 500,000", d: "D. 5,000,000", correct: "B", exp: "【正解：B】\nブラウザ上で手軽に使えるインポートウィザードの限界は5万件です。これを超える大量データや、スケジュール実行、削除操作などが必要な場合は「データローダ」を使います。" },
            { id: 62, cat: "データと分析の管理", q: "データローダを使用してレコードを「ハード削除」できますか？", a: "A. はい", b: "B. いいえ", correct: "A", exp: "【正解：A】\n設定で「Use Bulk API」を有効にすると、ハード削除（ごみ箱に入れず即座に完全抹消）が選択可能になります。大量の不要データを一気に消す際に便利ですが、復元できないので注意が必要です。" },
            { id: 63, cat: "データと分析の管理", q: "カスタムレポートタイプが必要な状況はどれですか？", a: "A. 標準のオブジェクト関係（取引先と商談など）を出す時", b: "B. 3つ以上の関連オブジェクトを組み合わせる、または特定の外部結合が必要な時", c: "C. グラフを表示する時", d: "D. ユーザーを削除する時", correct: "B", exp: "【正解：B】\n「商談のない取引先だけを表示したい（外部結合）」や「A-B-C-Dの4階層の関連を見たい」といった場合、標準のレポートタイプでは対応できないため、管理者がレポートの「型」を定義します。" },
            { id: 64, cat: "データと分析の管理", q: "レポートの「バケット項目」は何のために使いますか？", a: "A. データの削除", b: "B. 複数の値をグループ化（例：都道府県を地域ごとにまとめる）して表示する", c: "C. 数式を計算する", d: "D. 画像を表示する", correct: "B", exp: "【正解：B】\nマスタデータに「地方」という項目がなくても、レポート上で「東京・神奈川」なら「関東」といったグループ（バケット）を即席で作って集計することができます。" },
            { id: 65, cat: "データと分析の管理", q: "ダッシュボードの「実行ユーザー」を「ログインユーザー」にした場合の効果は？", a: "A. 全員が同じデータを見る", b: "B. 各ユーザーにアクセス権のあるデータのみが表示される（ダイナミックダッシュボード）", c: "C. ダッシュボードが編集できなくなる", d: "D. 毎日メールが届く", correct: "B", exp: "【正解：B】\nこれを「ダイナミックダッシュボード」と呼びます。見る人によってグラフの内容が、その人の持っている権限範囲のデータに絞り込まれます。組織の制限に注意（Enterpriseは5つ、Unlimitedは10個までなど）。" },
            { id: 66, cat: "データと分析の管理", q: "週に一度、すべてのデータをバックアップしたい。どの機能を使いますか？", a: "A. データエクスポートサービス", b: "B. データローダ", c: "C. レポートのスケジュール", d: "D. インポートウィザード", correct: "A", exp: "【正解：A】\n「ウィークリーエクスポート」サービスなどを使えば、組織内の全データをCSVファイルにまとめ、ダウンロード用のリンクを自動で生成・通知してくれます。" },
            { id: 67, cat: "データと分析の管理", q: "レポートで「クロスフィルタ」を使うと何ができますか？", a: "A. 2つの無関係なオブジェクトを比較する", b: "B. 関連レコードの有無（商談のない取引先など）で親レコードを絞り込む", c: "C. 通貨を換算する", d: "D. グラフの形を変える", correct: "B", exp: "【正解：B】\n「商談（子）がある取引先（親）」や、逆に「活動（子）が1件も登録されていないリード（親）」といった条件でフィルタリングできます。非常に強力な分析手段です。" },
            { id: 68, cat: "データと分析の管理", q: "数式項目とレポートの「サマリー数式」の違いは？", a: "A. サマリー数式はレポートの集計行でのみ計算される", b: "B. 数式項目はデータベースに保存される", c: "C. サマリー数式は他のレポートから参照できる", d: "D. AとB", correct: "D", exp: "【正解：D】\nサマリー数式はレポート上でのみ動く使い捨ての計算です。一方で数式項目はオブジェクトに定義され、どこからでも使えます。" },
            { id: 69, cat: "データと分析の管理", q: "レポートフォルダの共有単位は？", a: "A. ユーザー、役割、公開グループ", b: "B. レコード所有者のみ", c: "C. 組織全体のみ", d: "D. プロファイルのみ", correct: "A", exp: "【正解：A】\nフォルダ単位で、特定の個人、特定の役割（上司など）、またはあらかじめ作ったグループに対して「閲覧のみ」「編集可能」「管理可能」の権限を割り当てます。" },
            { id: 70, cat: "データと分析の管理", q: "「すべてのデータの参照」権限を持つユーザーができることは？", a: "A. 共有設定に関わらず、組織内のすべてのレコードを見ることができる", b: "B. 全ユーザーのパスワードを変える", c: "C. 組織の設定を削除する", d: "D. ライセンスを増やす", correct: "A", exp: "【正解：A】\nOWDが非公開であっても、この権限があればすべてのデータが見えます。主に管理者や監査担当者に付与される強力な権限です。" },
            { id: 71, cat: "データと分析の管理", q: "データインポートウィザードで重複をチェックする基準にできるのは？", a: "A. 名前、メール、外部ID", b: "B. 住所", c: "C. 電話番号", d: "D. 作成日", correct: "A", exp: "【正解：A】\nインポート時に既存レコードを上書き（更新）したい場合、どの項目が一致したら「同じ人」とみなすかを指定できます。" },
            { id: 72, cat: "データと分析の管理", q: "ダッシュボードコンポーネントとして使用できるのはどれですか？", a: "A. グラフ、ゲージ、総計値、テーブル", b: "B. ワークフロー", c: "C. ページレイアウト", d: "D. 数式のみ", correct: "A", exp: "【正解：A】\nレポートのデータを元に、円グラフ、棒グラフ、達成率を示すゲージ、最新10件のテーブル表示などが選べます。" },
            { id: 73, cat: "データと分析の管理", q: "ごみ箱に保管されたレコードは何日間保存されますか？", a: "A. 7日", b: "B. 15日", c: "C. 30日", d: "D. 90日", correct: "B", exp: "【正解：B】\n削除されたデータは15日間保持されます。その間なら「元に戻す」ことが可能ですが、15日を過ぎるか、ストレージ容量がいっぱいになると古いものから完全に消去されます。" },
            { id: 74, cat: "データと分析の管理", q: "商談のフェーズ滞在時間をレポートしたい。何を使いますか？", a: "A. 商談履歴レポート", b: "B. 商談トレンドレポート", c: "C. マトリックスレポート", d: "D. AまたはB", correct: "D", exp: "【正解：D】\n項目の履歴管理を有効にしていれば、商談履歴レポートで「どのフェーズに何日間いたか」を分析できます。またトレンドレポートでは過去の特定時点との比較が可能です。" },
            { id: 75, cat: "データと分析の管理", q: "外部オブジェクト（Salesforce Connect）の用途は？", a: "A. 外部のSQLサーバーなどのデータを、Salesforce内にコピーせずにリアルタイムで参照する", b: "B. データをCSVで書き出す", c: "C. 画像を保存する", d: "D. ユーザーを管理する", correct: "A", exp: "【正解：A】\nSalesforceの外にある巨大なデータベースの情報を、まるでSalesforceのレコードであるかのように画面に表示・検索できます。データを取り込まないのでストレージを節約できます。" },
            { id: 76, cat: "データと分析の管理", q: "レポートの「結合レポート（Joined Report）」とは何ですか？", a: "A. 異なるレポートタイプを1つの画面に並べて表示する", b: "B. 1つの表を2つに分ける", c: "C. 外部データを取り込む", d: "D. グラフを2つにする", correct: "A", exp: "【正解：A】\n「取引先」をキーにして、その横に「商談のデータ」と「ケースのデータ」を並べて表示する、といった使い方ができます。1つの画面で多角的な分析が可能です。" },
            { id: 77, cat: "データと分析の管理", q: "ダッシュボードをメールで自動送信する際、誰が受信できますか？", a: "A. 組織内のユーザーのみ", b: "B. 任意のメールアドレス（外部も可）", c: "C. 指定された公開グループや役割", d: "D. AとC", correct: "D", exp: "【正解：D】\n標準機能では、Salesforceのライセンスを持っている社内のユーザーやグループのみが受信可能です。外部の人に送るには、別途配布用の仕組み（Experience Cloudなど）が必要です。" },
            { id: 78, cat: "データと分析の管理", q: "レポートの結果が2,000件を超える場合、どうなりますか？", a: "A. エラーになる", b: "B. 画面には2,000件まで表示されるが、エクスポートすれば全件取得できる", c: "C. 自動で削除される", d: "D. レポートタイプが変わる", correct: "B", exp: "【正解：B】\nブラウザの表示負荷を抑えるための制限です。データが消えたわけではないので、詳細をすべて見たい場合はCSVやExcelでエクスポートします。" },
            { id: 79, cat: "データと分析の管理", q: "インポートウィザードで「ワークフローをトリガーする」設定をオフにできますか？", a: "A. はい", b: "B. いいえ", correct: "A", exp: "【正解：A】\nインポート画面のチェックボックスで切り替えられます。大量データを入れる際、通知メールが大量に飛ぶのを防ぐためにオフにすることがよくあります。" },
            { id: 80, cat: "データと分析の管理", q: "積み上げ集計項目で可能な計算はどれですか？", a: "A. 合計、最小、最大、件数", b: "B. 平均", c: "C. 掛け算", d: "D. 文字列結合", correct: "A", exp: "【正解：A】\n平均（Average）は標準機能では選べません。「合計」項目と「件数」項目を積み上げで作っておき、それらを割る「数式項目」を作ることで対応します。" },

            // ワークフロー/プロセスの自動化 (81-100)
            { id: 81, cat: "ワークフロー/プロセスの自動化", q: "フロー（Flow Builder）でできるが、ワークフローではできないことは？", a: "A. レコードの更新", b: "B. レコードの作成、削除", c: "C. メール送信", d: "D. アウトバウンドメッセージ送信", correct: "B", exp: "【正解：B】\n「ワークフロー」は自分のレコードを更新するか、親レコードを少し更新する程度しかできませんでしたが、「フロー」は全く関係ないレコードの作成や、不要になったデータの削除も自在に行えます。" },
            { id: 82, cat: "ワークフロー/プロセスの自動化", q: "承認プロセスで「最初の承認アクション」として設定できるのは？", a: "A. レコードのロック", b: "B. 項目の更新", c: "C. メールアラート送信", d: "D. 上記すべて", correct: "D", exp: "【正解：D】\n申請が始まった瞬間に、他人が編集できないように「ロック」をかけ、ステータスを「承認待ち」に「更新」し、上司に「メール通知」を送る、といった一連のアクションを設定できます。" },
            { id: 83, cat: "ワークフロー/プロセスの自動化", q: "レコードが特定の条件を満たした時、3日後にメールを送りたい。何を使いますか？", a: "A. 即時アクション", b: "B. スケジュール済みパス（フロー）または時間ベースのアクション", c: "C. 割り当てルール", d: "D. エスカレーションルール", correct: "B", exp: "【正解：B】\nフローの「スケジュール済みパス」を使えば、特定の日付項目（完了予定日など）の前後や、条件合致から数日後といったタイミングで処理を予約できます。" },
            { id: 84, cat: "ワークフロー/プロセスの自動化", q: "フローで「ループ（Loop）」を使用する目的は？", a: "A. レコードのコレクション（複数レコード）を1つずつ処理する", b: "B. 画面を何度も出す", c: "C. エラーを繰り返す", d: "D. ログインを繰り返す", correct: "A", exp: "【正解：A】\n「未完了の商談をすべて取得」した後、その1件1件に対して「メールを送る」といった連続処理を行う際、このループ要素が必須となります。" },
            { id: 85, cat: "ワークフロー/プロセスの自動化", q: "プロセスビルダー（Process Builder）とフローの違いについて正しいのは？", a: "A. プロセスビルダーは今後廃止予定で、フローへの移行が推奨されている", b: "B. プロセスビルダーの方が多機能", c: "C. フローは自動化できない", d: "D. 違いはない", correct: "A", exp: "【正解：A】\nSalesforceは自動化ツールを「フロー」に一本化する方針です。プロセスビルダーで作れるものはすべてフローで作れ、かつフローの方が実行速度も速いです。" },
            { id: 86, cat: "ワークフロー/プロセスの自動化", q: "承認プロセスの「代理承認者」はどこで設定しますか？", a: "A. ユーザーレコード", b: "B. プロファイル", c: "C. 役割", d: "D. 共有ルール", correct: "A", exp: "【正解：A】\nユーザーが休暇を取る際、自分の代わりに誰が承認ボタンを押せるかを、その人のユーザー設定（個人設定）画面で指定します。" },
            { id: 87, cat: "ワークフロー/プロセスの自動化", q: "レコードトリガーフローで「高速フィールド更新（Before Save）」を選ぶメリットは？", a: "A. 保存速度が10倍速い", b: "B. 保存される前に値を書き換えるため、処理効率が非常に良い", c: "C. 関連レコードを更新できる", d: "D. メールを送れる", correct: "B", exp: "【正解：B】\n自レコードの値を上書きするだけの処理なら、データベースに書き込まれる前に実行するこのモードが最速です。逆に他人のレコードを触ったりメールを送る場合は「アクションと関連レコード」モードを選びます。" },
            { id: 88, cat: "ワークフロー/プロセスの自動化", q: "承認プロセスにおいて、最終承認後に実行できないアクションはどれですか？", a: "A. レコードの削除", b: "B. 項目の更新", c: "C. タスクの作成", d: "D. メールアラート", correct: "A", exp: "【正解：A】\n承認プロセスの標準アクションには「削除」は含まれません。もし承認後に削除したい場合は、アクションとして「フロー」を呼び出し、そのフローの中で削除を実行させる必要があります。" },
            { id: 89, cat: "ワークフロー/プロセスの自動化", q: "「画面フロー」を実行できる場所は？", a: "A. レコードページ上のボタン", b: "B. Lightningページのコンポーネント", c: "C. Experience Cloud サイト", d: "D. 上記すべて", correct: "D", exp: "【正解：D】\n非常に汎用性が高いです。例えばレコードの詳細画面に「住所変更ウィザード」を埋め込んだり、サイトで顧客に入力させたりすることができます。" },
            { id: 90, cat: "ワークフロー/プロセスの自動化", q: "フローのエラーが発生した際、管理者はどうやって通知を受け取りますか？", a: "A. メールが届く（フォールトメール）", b: "B. 画面が赤くなる", c: "C. 通知はこない", d: "D. 電話がかかってくる", correct: "A", exp: "【正解：A】\nフローが途中で止まると、設定された管理者に「どの要素で」「どんなエラー（ガバナ制限など）」が起きたかの詳細がメールで飛びます。これをデバッグのヒントにします。" },
            { id: 91, cat: "ワークフロー/プロセスの自動化", q: "複数の承認ステップがある場合、1つ目のステップが却下されたらどうなりますか？", a: "A. プロセス全体が終了（却下アクション実行）される", b: "B. 次のステップに進む", c: "C. 削除される", d: "D. 管理者に転送される", correct: "A", exp: "【正解：A】\n通常、ステップが却下されるとそれ以降のステップは行われず、最終却下アクションが走ります。ただし、設定によっては「前のステップに戻す」ような挙動もカスタマイズ可能です。" },
            { id: 92, cat: "ワークフロー/プロセスの自動化", q: "フローで「サブフロー（Subflow）」を使う利点は？", a: "A. 共通の処理を部品化して、複数のフローから呼び出せる", b: "B. 処理速度を落とす", c: "C. ライセンスを節約する", d: "D. 文字を大きくする", correct: "A", exp: "【正解：A】\n例えば「エラーログを記録する」というフローを作っておき、他のすべてのフローからそれを部品（サブフロー）として呼び出すことで、開発と保守の手間を大幅に減らせます。" },
            { id: 93, cat: "ワークフロー/プロセスの自動化", q: "自動化が無限ループになるのを防ぐためにSalesforceが設定している制限は？", a: "A. 1回のトランザクションあたりの要素実行数制限（ガバナ制限）", b: "B. ユーザーの削除", c: "C. インターネットの切断", d: "D. サーバーの再起動", correct: "A", exp: "【正解：A】\nクラウド環境を公平に使うためのルールです。1つの処理で2,000個以上の要素を通ろうとするとエラーで止まります。ループの中に「レコード更新」などを置く際は特に注意が必要です。" },
            { id: 94, cat: "ワークフロー/プロセスの自動化", q: "フローでレコードを取得する際、見つからなかった場合の結果はどうなりますか？", a: "A. エラーで止まる", b: "B. 変数が空（null）になる", c: "C. 適当なレコードが入る", d: "D. 自動で作成される", correct: "B", exp: "【正解：B】\nエラーにはなりませんが、変数が空になります。その後の処理で「もし変数が空だったらエラー画面を出す」といった分岐（決定要素）を作るのが正しい設計です。" },
            { id: 95, cat: "ワークフロー/プロセスの自動化", q: "組織の「プロセス自動化設定」で設定できるのは？", a: "A. デフォルトのワークフローユーザー", b: "B. フローの実行モード", c: "C. 承認プロセスの通知方法", d: "D. 上記すべて", correct: "D", exp: "【正解：D】\n自動化が動く際の共通の「舞台裏」設定です。誰の名前で実行するか、ポーズ（一時停止）されたフローを誰が管理するかなどを決めます。" },
            { id: 96, cat: "ワークフロー/プロセスの自動化", q: "商談のフェーズが「交渉」になったら、自動的にタスクを作成したい。何が最も簡単ですか？", a: "A. フロー", b: "B. 承認プロセス", c: "C. 共有ルール", d: "D. ページレイアウト", correct: "A", exp: "【正解：A】\nレコードトリガーフローで、フェーズの変更を検知して「レコード作成（Task）」要素を一つ置くだけで完成します。" },
            { id: 97, cat: "ワークフロー/プロセスの自動化", q: "「並列承認」とは何ですか？", a: "A. 複数の人が同時に承認しないと次に進めない、または誰か一人が承認すれば良い設定", b: "B. 2つのプロセスを同時に動かす", c: "C. 承認と却下を同時に行う", d: "D. 意味はない", correct: "A", exp: "【正解：A】\n「マネージャー3人のうち誰か1人がOKなら通過」や「役員全員の合意が必要」といった複雑な承認経路を設定できます。" },
            { id: 98, cat: "ワークフロー/プロセスの自動化", q: "フローの「デバッグ（Debug）」機能でできることは？", a: "A. 本番データを書き換えずに実行をシミュレーションする（ロールバック）", b: "B. ユーザーの削除", c: "C. パスワードの確認", d: "D. レポートの作成", correct: "A", exp: "【正解：A】\n「もしこの値で動かしたらどうなるか」を確認できます。ロールバックを有効にすれば、テストで作成されたデータは自動で消えるため、本番環境を汚さずにチェックできます。" },
            { id: 99, cat: "ワークフロー/プロセスの自動化", q: "アウトバウンドメッセージを送信できる自動化ツールは？", a: "A. ワークフロー、フロー", b: "B. レポート", c: "C. 割り当てルール", d: "D. エスカレーションルール", correct: "A", exp: "【正解：A】\n外部システムに対して「データが更新されたからそっちも更新して」という通知を飛ばす機能です。古くからある機能ですが、現在もフローから呼び出すことが可能です。" },
            { id: 100, cat: "ワークフロー/プロセスの自動化", q: "フローの「一時停止（Pause）」アクションが使えるのは？", a: "A. 画面フロー", b: "B. 自動起動フロー（スケジュール済みなど）", c: "C. すべてのフロー", d: "D. 承認プロセス", correct: "B", exp: "【正解：B】\n「1時間待ってからメールを送る」や「特定のイベントが起きるまで待機する」といった非同期処理に使われます。画面フローはユーザーが操作中のため、一時停止して待機させることはできません。" }
        ];

        const quizApp = {
            currentPool: [], currentIndex: 0, score: 0, failedList: [],
            sessionStats: { total: 0, correct: 0 }, catStats: {}, isReviewMode: false,
            init() { 
                this.renderCategoryList(); 
                this.updateUI(); 
            },
            renderCategoryList() {
                const cats = {}; 
                ADMIN_DATA.forEach(q => cats[q.cat] = (cats[q.cat] || 0) + 1);
                const container = document.getElementById('category-list-container'); 
                container.innerHTML = '';
                Object.keys(cats).sort().forEach(cat => {
                    const div = document.createElement('div');
                    div.className = "bg-white border-2 border-slate-100 p-5 rounded-3xl flex justify-between items-center cursor-pointer transition hover:border-cyan-400 group shadow-sm active:scale-95";
                    div.innerHTML = `
                        <div class='flex flex-col'>
                            <span class='text-[10px] font-black text-slate-400 uppercase'>${cats[cat]} Questions</span>
                            <span class='text-sm font-bold text-slate-700'>${cat}</span>
                        </div>
                        <div class='w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center group-hover:bg-cyan-600 group-hover:text-white transition-all shadow-sm'>
                            <i class='fas fa-play text-[10px]'></i>
                        </div>`;
                    div.onclick = () => this.startByCategory(cat);
                    container.appendChild(div);
                });
            },
            start(random) { 
                this.isReviewMode = false; 
                this.currentPool = random ? [...ADMIN_DATA].sort(()=>Math.random()-0.5) : [...ADMIN_DATA]; 
                this.launch(random ? "Random Challenge" : "Standard Marathon"); 
            },
            startByCategory(cat) { 
                this.isReviewMode = false; 
                this.currentPool = ADMIN_DATA.filter(q => q.cat === cat); 
                this.launch(`Drill: ${cat}`); 
            },
            startReview() { 
                if(!this.failedList.length) return; 
                this.isReviewMode = true; 
                this.currentPool = [...this.failedList].sort(()=>Math.random()-0.5); 
                this.launch("Error Recovery"); 
            },
            launch(mode) { 
                this.currentIndex = 0; 
                this.score = 0; 
                document.getElementById('quiz-mode-label').innerText = mode; 
                this.showScreen('quiz-screen'); 
                this.loadQuestion(); 
            },
            showQuitModal() { document.getElementById('quit-modal').classList.remove('hidden'); },
            hideQuitModal() { document.getElementById('quit-modal').classList.add('hidden'); },
            quitQuiz() { 
                this.hideQuitModal(); 
                this.showScreen('selection-screen'); 
                this.updateUI(); 
            },
            loadQuestion() {
                const q = this.currentPool[this.currentIndex]; 
                this.answered = false;
                const progressPercent = ((this.currentIndex + 1) / this.currentPool.length) * 100;
                document.getElementById('progress-bar').style.width = `${progressPercent}%`;
                document.getElementById('progress-text').innerText = `QUESTION ${this.currentIndex+1}/${this.currentPool.length}`;
                document.getElementById('score-text').innerText = `${Math.round((this.score/(this.currentIndex||1))*100)}%`;
                document.getElementById('category-badge').innerText = q.cat;
                document.getElementById('question-text').innerText = q.q;
                
                const container = document.getElementById('options-container'); 
                container.innerHTML = '';
                ['A','B','C','D'].forEach(key => {
                    const optionText = q[key.toLowerCase()];
                    if(optionText) {
                        const btn = document.createElement('button');
                        btn.className = "option-btn w-full text-left p-6 rounded-2xl border-2 border-slate-100 hover:border-cyan-400 hover:bg-cyan-50 transition flex items-start group bg-white shadow-sm";
                        btn.innerHTML = `
                            <span class='inline-block w-10 h-10 rounded-xl bg-slate-100 text-slate-400 font-black text-center leading-10 mr-6 group-hover:bg-cyan-600 group-hover:text-white transition flex-shrink-0'>${key}</span>
                            <span class='text-slate-700 font-bold text-lg pt-1 leading-tight'>${optionText}</span>`;
                        btn.onclick = () => this.handleAnswer(key, btn);
                        container.appendChild(btn);
                    }
                });
                document.getElementById('explanation-container').classList.add('hidden');
                window.scrollTo(0,0);
            },
            handleAnswer(choice, btn) {
                if(this.answered) return; 
                this.answered = true;
                const q = this.currentPool[this.currentIndex]; 
                const correctSet = q.correct.split(',').map(s=>s.trim()); 
                const isCorrect = correctSet.includes(choice);
                
                this.sessionStats.total++; 
                if(!this.catStats[q.cat]) this.catStats[q.cat] = {correct:0, total:0}; 
                this.catStats[q.cat].total++;

                if(isCorrect) { 
                    this.score++; 
                    this.sessionStats.correct++; 
                    this.catStats[q.cat].correct++; 
                    if(this.isReviewMode) this.failedList = this.failedList.filter(item=>item.id!==q.id); 
                } else {
                    if(!this.failedList.find(i=>i.id===q.id)) { this.failedList.push(q); }
                }

                document.querySelectorAll('.option-btn').forEach(b => { 
                    b.disabled = true; 
                    const optKey = b.querySelector('span').innerText;
                    if(correctSet.includes(optKey)) {
                        b.classList.add('border-green-500','bg-green-50');
                        b.classList.remove('border-slate-100');
                    }
                });

                if(!isCorrect) {
                    btn.classList.add('border-red-500','bg-red-50');
                    btn.classList.remove('border-slate-100');
                }

                const badge = document.getElementById('result-badge');
                badge.className = `flex items-center p-6 rounded-2xl mb-6 font-black text-lg italic tracking-widest ${isCorrect?'bg-green-100 text-green-700':'bg-red-100 text-red-700'}`;
                badge.innerHTML = isCorrect ? "<i class='fas fa-check-circle mr-3'></i> CORRECT" : `<i class='fas fa-times-circle mr-3'></i> INCORRECT (正解: ${q.correct})`;
                
                document.getElementById('explanation-text').innerText = q.exp;
                document.getElementById('explanation-container').classList.remove('hidden');
                
                setTimeout(() => { 
                    document.getElementById('explanation-container').scrollIntoView({ behavior: 'smooth', block: 'center' }); 
                }, 100);
                
                this.updateUI();
            },
            nextQuestion() { 
                this.currentIndex++; 
                if(this.currentIndex < this.currentPool.length) {
                    this.loadQuestion(); 
                } else {
                    this.showResult(); 
                }
            },
            showResult() {
                this.showScreen('result-screen'); 
                const percent = Math.round((this.score / this.currentPool.length) * 100);
                document.getElementById('final-score').innerText = `${percent}%`;
                document.getElementById('final-stats').innerText = `${this.currentPool.length}問中 ${this.score}問正解`;
                
                const table = document.getElementById('analysis-table-body'); 
                table.innerHTML = '';
                Object.keys(this.catStats).forEach(cat => {
                    const s = this.catStats[cat]; 
                    const catPerc = Math.round((s.correct/s.total)*100);
                    let judge = catPerc>=80?"Strong":(catPerc>=60?"Average":"Weak"); 
                    let cls = catPerc>=80?"text-green-600 bg-green-50":(catPerc>=60?"text-yellow-600 bg-yellow-50":"text-red-500 bg-red-50");
                    table.innerHTML += `
                        <tr class='group hover:bg-slate-50 transition'>
                            <td class='p-6 font-bold text-slate-700 text-sm'>${cat}</td>
                            <td class='p-6 text-right'>
                                <span class='px-4 py-1.5 rounded-full text-[10px] font-black uppercase ${cls}'>${judge} (${catPerc}%)</span>
                            </td>
                        </tr>`;
                });
                
                document.getElementById('result-review-btn').classList.toggle('hidden', this.failedList.length === 0);
                document.getElementById('final-emoji').innerText = percent>=80?"🏆":(percent>=60?"📚":"⏳");
            },
            updateUI() {
                const wrongCount = this.failedList.length; 
                const totalAttempts = this.sessionStats.total;
                const overallAccuracy = totalAttempts > 0 ? Math.round((this.sessionStats.correct / totalAttempts) * 100) : 0;
                
                document.getElementById('header-wrong-count').innerText = wrongCount;
                document.getElementById('dash-total-attempts').innerText = totalAttempts;
                document.getElementById('dash-overall-accuracy').innerText = `${overallAccuracy}%`;
                document.getElementById('overall-progress-text').innerText = `${overallAccuracy}%`;
                document.getElementById('failed-count-display').innerText = wrongCount;
                document.getElementById('overall-progress-bar').style.width = `${overallAccuracy}%`;
                document.getElementById('review-section').classList.toggle('hidden', wrongCount === 0);
            },
            showScreen(id) { 
                ['selection-screen', 'quiz-screen', 'result-screen'].forEach(s => document.getElementById(s).classList.add('hidden')); 
                document.getElementById(id).classList.remove('hidden'); 
                window.scrollTo(0,0); 
            }
        };

        window.onload = () => quizApp.init();
    </script>
</body>
</html>
